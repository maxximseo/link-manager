# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Claude Code: –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Supabase

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Supabase –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä–æ–π –±–∞–∑—ã DigitalOcean.

## –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Supabase

```
DB_HOST=nuykefcuninjboyrcxcn.supabase.co
DB_PORT=5432
DB_NAME=postgres
DB_USER=postgres
DB_PASSWORD=<—É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ .env>
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü –≤ Supabase

–í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –ø–∞–ø–∫–µ `database/`:

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
1. **users** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
2. **projects** - –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. **sites** - –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∞–π—Ç—ã –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
4. **project_links** - —Å—Å—ã–ª–∫–∏ –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö
5. **project_articles** - —Å—Ç–∞—Ç—å–∏ –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö
6. **placements** - —Ä–∞–∑–º–µ—â–µ–Ω–∏—è (–æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
7. **placement_content** - –∫–æ–Ω—Ç–µ–Ω—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏–π

### –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
8. **transactions** - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
9. **discount_tiers** - —É—Ä–æ–≤–Ω–∏ —Å–∫–∏–¥–æ–∫ (—É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!)
10. **renewal_history** - –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–¥–ª–µ–Ω–∏–π

### –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:
11. **referral_transactions** - —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
12. **referral_withdrawals** - –≤—ã–≤–æ–¥—ã —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤

### –°–ª—É–∂–µ–±–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
13. **notifications** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
14. **audit_log** - –∂—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞
15. **registration_tokens** - —Ç–æ–∫–µ–Ω—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## –ü—Ä–æ—Ü–µ—Å—Å –∏–º–ø–æ—Ä—Ç–∞

### –®–∞–≥ 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ —Å–≤–æ–µ–π –º–∞—à–∏–Ω–µ:

```bash
export OLD_DB_HOST=—Ö–æ—Å—Ç.db.ondigitalocean.com
export OLD_DB_PORT=25060
export OLD_DB_NAME=linkmanager
export OLD_DB_USER=doadmin
export OLD_DB_PASSWORD=–ø–∞—Ä–æ–ª—å
node scripts/export-from-digitalocean.js
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `migration-data/export-[TIMESTAMP].json`

### –®–∞–≥ 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –≤ Claude Code

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω:
1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å export —Ñ–∞–π–ª
2. –í—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –≤ —á–∞—Ç Claude Code
3. –ü–æ–ø—Ä–æ—Å–∏—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å

### –®–∞–≥ 3: Claude Code –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–º–ø–æ—Ä—Ç

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç export —Ñ–∞–π–ª, Claude –¥–æ–ª–∂–µ–Ω:

1. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª** –≤ –ø–∞–ø–∫—É `migration-data/`
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É** —Ñ–∞–π–ª–∞
3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç**:
   ```bash
   node scripts/import-to-supabase.js migration-data/export-TIMESTAMP.json
   ```
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
   ```bash
   node test-supabase-connection.js
   ```

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è Claude Code

### –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—à–ª–µ—Ç export —Ñ–∞–π–ª:

```bash
# 1. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Å–ª–∞–ª —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
# Write to: migration-data/export-[TIMESTAMP].json

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç
node scripts/import-to-supabase.js migration-data/export-[TIMESTAMP].json

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
node test-supabase-connection.js

# 4. –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
# –°–∫—Ä–∏–ø—Ç import-to-supabase.js –ø–æ–∫–∞–∂–µ—Ç:
# - –°–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ
# - –°–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç—ã)
# - –°–∫–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫
```

## –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–ø—É—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (ON CONFLICT DO NOTHING)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ sequences (–¥–ª—è –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã—Ö ID)
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å (–æ—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### ‚ö†Ô∏è –ù–∞ —á—Ç–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ:
- **discount_tiers** —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ - –∏–º–ø–æ—Ä—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç —ç—Ç–∏ –∑–∞–ø–∏—Å–∏
- **Foreign keys** - –∏–º–ø–æ—Ä—Ç –∏–¥–µ—Ç –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- **Passwords** - —Ö—ç—à–∏ –ø–∞—Ä–æ–ª–µ–π –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å
- **Timestamps** - —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
SELECT 'users' as table_name, COUNT(*) FROM users
UNION ALL
SELECT 'projects', COUNT(*) FROM projects
UNION ALL
SELECT 'sites', COUNT(*) FROM sites
UNION ALL
SELECT 'placements', COUNT(*) FROM placements;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ ID
SELECT pg_get_serial_sequence('users', 'id') as sequence_name,
       last_value
FROM users_id_seq;
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ export —Ñ–∞–π–ª–∞

–û–∂–∏–¥–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç:

```json
{
  "timestamp": "2024-12-13T10:30:00.000Z",
  "database": "linkmanager",
  "tables": {
    "users": [
      {"id": 1, "email": "user@example.com", ...}
    ],
    "projects": [...],
    "sites": [...],
    ...
  },
  "metadata": {
    "total_records": 1000,
    "export_duration_ms": 5000
  }
}
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "Cannot connect to database"
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª, —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ DB_PASSWORD –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω

### –ü—Ä–æ–±–ª–µ–º–∞: "Duplicate key violation"
**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è

### –ü—Ä–æ–±–ª–µ–º–∞: "Foreign key violation"
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∏–º–ø–æ—Ä—Ç–∞ –≤ —Å–∫—Ä–∏–ø—Ç–µ

### –ü—Ä–æ–±–ª–µ–º–∞: "File not found"
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ migration-data/

## –ü—Ä–∏–º–µ—Ä –¥–∏–∞–ª–æ–≥–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: "–£ –º–µ–Ω—è –µ—Å—Ç—å export —Ñ–∞–π–ª, –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π –µ–≥–æ"

**Claude**:
1. –ü—Ä–æ–≤–µ—Ä—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–∞
2. –°–æ—Ö—Ä–∞–Ω—é –µ–≥–æ –≤ migration-data/
3. –ó–∞–ø—É—â—É –∏–º–ø–æ—Ä—Ç
4. –ü–æ–∫–∞–∂—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ Claude –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ –°–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ
- ‚ö†Ô∏è –°–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç—ã)
- ‚ùå –û—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ç–∞–±–ª–∏—Ü–∞–º

## –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–º–ø–æ—Ä—Ç—É

–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫:
- [x] Supabase –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [x] –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [x] –°–∫—Ä–∏–ø—Ç—ã export/import –≥–æ—Ç–æ–≤—ã
- [x] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü —Å–æ–≤–ø–∞–¥–∞–µ—Ç
- [x] .env —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Export —Ñ–∞–π–ª –ø–æ–ª—É—á–µ–Ω –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] –ò–º–ø–æ—Ä—Ç –∑–∞–ø—É—â–µ–Ω
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `npm run dev`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö placements
5. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

**–ì–æ—Ç–æ–≤ –∫ –∏–º–ø–æ—Ä—Ç—É!** –ñ–¥—É export —Ñ–∞–π–ª –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
